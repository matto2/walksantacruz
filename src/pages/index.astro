---
import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";
import Layout from "../layouts/Layout.astro";
import heroImage from "../assets/downtown_hero.jpg";
import mapBg from "../assets/map-bg.jpg";
---

<Layout
  title="Walk Santa Cruz - Local Walking Tours | Guided Tours in Santa Cruz, CA"
  description="Discover the hidden gems and fascinating history of Santa Cruz with our expert-guided walking tours. Local guides, local stories."
>
  <!-- Hero Section - Full Bleed -->
  <section
    class="full-bleed relative min-h-[600px] flex items-center justify-center"
  >
    <!-- Hero Video with Image Fallback -->
    <div class="absolute inset-0">
      <video
        id="hero-video"
        autoplay
        muted
        playsinline
        class="w-full h-full object-cover"
        poster={heroImage.src}
      >
        <source src="/IMG_9072_web.mp4" type="video/mp4" />
        <!-- Fallback image for browsers that don't support video -->
        <Image
          src={heroImage}
          alt="Downtown Santa Cruz"
          class="w-full h-full object-cover"
          loading="eager"
          quality={80}
        />
      </video>
    </div>
    <!-- Dark gradient overlay -->
    <div class="absolute inset-0 bg-gradient-to-b from-black/40 to-black/0">
    </div>

    <div class="container relative z-10 text-center py-24">
      <h1
        class="text-5xl md:text-6xl lg:text-7xl font-bold mb-6 text-white drop-shadow-md"
      >
        Local guides, local stories.
      </h1>
      <p
        class="text-lg md:text-xl text-white font-semibold max-w-2xl mx-auto mb-8 drop-shadow-md"
      >
        Discover the hidden gems and fascinating history of Santa Cruz with our
        expert-guided walking tours.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <!-- Stripe booking link -->
        <!-- FareHarbor (disabled): <a href="https://fareharbor.com/embeds/book/walksantacruz/?full-items=yes" class="btn btn-lg">Book online now!</a> -->
        <a href="https://buy.stripe.com/5kQ00j3Kxa6P3VSgnZ1ck0j" class="btn btn-lg">Book Your Tour Now</a>
        <a href="/contact" class="btn btn-lg btn-secondary"
          >Request Private Tour</a
        >
      </div>
    </div>
  </section>

  <!-- Tour Section -->
  <section class="container py-16 md:py-24">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-3xl md:text-4xl font-bold mb-6">
        Our Santa Cruz Walking Tour
      </h2>

      <h3 class="text-2xl font-semibold text-primary mb-4">
        Downtown & Mission Hill Historic District Tour
      </h3>

      <p class="text-lg text-muted-foreground mb-8">
        Join us for a captivating journey through the heart of Santa Cruz. Our
        signature walking tour combines the vibrant downtown area with the
        historic Mission Hill district, offering a perfect blend of past and
        present.
      </p>

      <div class="grid md:grid-cols-3 gap-6 my-12">
        <div class="card">
          <div class="p-6 text-center">
            <Icon
              name="lucide:sparkles"
              class="w-12 h-12 text-[#e26f04] mb-4 mx-auto"
            />
            <h4 class="font-semibold text-lg mb-2">Fun & Informative</h4>
            <p class="text-muted-foreground">
              Our local guides share fascinating stories and little-known facts
              about Santa Cruz.
            </p>
          </div>
        </div>

        <div class="card">
          <div class="p-6 text-center">
            <Icon
              name="lucide:footprints"
              class="w-12 h-12 text-[#e26f04] mb-4 mx-auto"
            />
            <h4 class="font-semibold text-lg mb-2">Easy Walking</h4>
            <p class="text-muted-foreground">
              Comfortable pace with some stairs. No special equipment needed.
            </p>
          </div>
        </div>

        <div class="card">
          <div class="p-6 text-center">
            <Icon
              name="lucide:users-round"
              class="w-12 h-12 text-[#e26f04] mb-4 mx-auto"
            />
            <h4 class="font-semibold text-lg mb-2">Small Groups</h4>
            <p class="text-muted-foreground">
              Limited group sizes ensure a personalized experience with plenty
              of time for questions.
            </p>
          </div>
        </div>
      </div>

      <div class="card bg-muted/50 mb-8">
        <div class="p-8">
          <h4 class="text-xl font-semibold mb-6">Tour Information</h4>
          <div class="grid sm:grid-cols-2 gap-6">
            <div class="flex items-start gap-3">
              <Icon
                name="lucide:clock"
                class="w-5 h-5 text-[#e26f04] mt-1 flex-shrink-0"
              />
              <div>
                <div class="font-semibold mb-2">Duration</div>
                <div class="text-muted-foreground">1.5 hours</div>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <Icon
                name="lucide:dollar-sign"
                class="w-5 h-5 text-[#e26f04] mt-1 flex-shrink-0"
              />
              <div>
                <div class="font-semibold mb-2">Price</div>
                <div class="text-muted-foreground">$45 per person</div>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <Icon
                name="lucide:calendar"
                class="w-5 h-5 text-[#e26f04] mt-1 flex-shrink-0"
              />
              <div>
                <div class="font-semibold mb-2">Schedule</div>
                <div class="text-muted-foreground">
                  Friday, Saturday, and Sunday at 10am and 2pm
                </div>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <Icon
                name="lucide:map-pin"
                class="w-5 h-5 text-[#e26f04] mt-1 flex-shrink-0"
              />
              <div>
                <div class="font-semibold mb-2">Meeting Point</div>
                <div class="text-muted-foreground">
                  <a
                    href="https://maps.app.goo.gl/M7uF1gUT19KMFiMW8"
                    data-map-link
                    class="text-primary hover:underline cursor-pointer"
                  >
                    Abbott Square Market in Downtown Santa Cruz
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="text-center">
        <!-- Stripe booking link -->
        <!-- FareHarbor (disabled): <a href="https://fareharbor.com/embeds/book/walksantacruz/?full-items=yes" class="btn btn-lg">Book online now!</a> -->
        <a href="https://buy.stripe.com/5kQ00j3Kxa6P3VSgnZ1ck0j" class="btn btn-lg">Book This Tour</a>
      </div>
    </div>
  </section>

  <!-- Testimonials Section - HIDDEN FOR NOW -->
  <!-- <section class="full-bleed relative py-16 md:py-24">
    <div
      class="absolute inset-0 opacity-50"
      style={`background-image: url(${mapBg.src}); background-size: cover; background-position: center;`}
    >
    </div>
    <div class="container relative">
      <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">
        What Our Guests Say
      </h2>

      <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
        <div class="card">
          <div class="p-6">
            <p class="text-muted-foreground mb-4">
              "Our guide was incredibly knowledgeable about Santa Cruz history.
              We discovered so many hidden gems we never would have found on our
              own. Highly recommend this tour to anyone visiting the area!"
            </p>
            <div class="font-semibold">Sarah Johnson</div>
            <div class="text-sm text-muted-foreground">San Francisco, CA</div>
          </div>
        </div>

        <div class="card">
          <div class="p-6">
            <p class="text-muted-foreground mb-4">
              "This walking tour was the highlight of our California coast trip!
              The stories about Mission Hill were fascinating, and our guide
              made the history come alive. Perfect pace and very engaging."
            </p>
            <div class="font-semibold">Michael Chen</div>
            <div class="text-sm text-muted-foreground">Seattle, WA</div>
          </div>
        </div>

        <div class="card">
          <div class="p-6">
            <p class="text-muted-foreground mb-4">
              "As a California native, I thought I knew Santa Cruz well, but
              this tour showed me a completely different side of the city. The
              local insights and historical context made for an unforgettable
              experience."
            </p>
            <div class="font-semibold">Emma Rodriguez</div>
            <div class="text-sm text-muted-foreground">Los Angeles, CA</div>
          </div>
        </div>
      </div>
    </div>
  </section> -->

  <!-- CTA Section -->
  <section id="book" class="full-bleed relative py-16 md:py-24">
    <div
      class="absolute inset-0 opacity-50"
      style={`background-image: url(${mapBg.src}); background-size: cover; background-position: center;`}
    >
    </div>
    <div class="container relative">
    <div class="max-w-2xl mx-auto text-center">
      <h2 class="text-3xl md:text-4xl font-bold mb-6">
        Ready to Explore Santa Cruz?
      </h2>
      <p class="text-lg text-muted-foreground mb-8">
        Join us for a memorable walking tour through the heart of Santa Cruz.
        Book your spot today or contact us for a private tour experience.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <!-- Stripe booking link -->
        <!-- FareHarbor (disabled): <a href="https://fareharbor.com/embeds/book/walksantacruz/?full-items=yes" class="btn btn-lg">Book online now!</a> -->
        <a href="https://buy.stripe.com/5kQ00j3Kxa6P3VSgnZ1ck0j" class="btn btn-lg">Book Your Tour</a>
        <a href="/contact" class="btn btn-lg btn-secondary"
          >Request Private Tour</a
        >
      </div>
    </div>
    </div>
  </section>

  <!-- Map Modal (desktop only) -->
  <div id="map-modal" class="hidden fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
    <div class="card max-w-4xl w-full">
      <div class="p-6">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-xl font-bold">Abbott Square Market</h3>
          <button id="close-map-modal" class="text-muted-foreground hover:text-foreground">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <div class="w-full h-96 rounded-lg overflow-hidden">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3187.478677471583!2d-122.02802742415363!3d36.97450577219796!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x808e40266abd9cbb%3A0xb9f2d632857836ec!2s725%20Front%20St%2C%20Santa%20Cruz%2C%20CA%2095060!5e0!3m2!1sen!2sus!4v1760105797730!5m2!1sen!2sus"
            width="100%"
            height="100%"
            style="border:0;"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Abbott Square Market Location"
          ></iframe>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script is:inline>
  function setupVideoPlaylist() {
    const video = document.getElementById("hero-video");
    if (!video) return;

    const playlist = ["/output.mp4", "/IMG_9072_web.mp4"];
    let currentIndex = 0;

    video.addEventListener("ended", function () {
      currentIndex = (currentIndex + 1) % playlist.length;
      video.src = playlist[currentIndex];
      video.load();
      video.play().catch((e) => {
        // Ignore AbortError which happens when switching videos
        if (e.name !== "AbortError") {
          console.error("Video playback error:", e);
        }
      });
    });
  }

  // Run on initial load
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", setupVideoPlaylist);
  } else {
    setupVideoPlaylist();
  }

  // Re-run after view transitions
  document.addEventListener("astro:page-load", setupVideoPlaylist);

  // Map link handler
  function setupMapLink() {
    const mapLink = document.querySelector('[data-map-link]');
    if (!mapLink) return;

    mapLink.addEventListener('click', function(e) {
      // Check if desktop (screen width >= 768px)
      if (window.innerWidth >= 768) {
        e.preventDefault();
        const modal = document.getElementById('map-modal');
        if (modal) {
          modal.classList.remove('hidden');
        }
      }
      // On mobile, let the default link behavior open the map app
    });

    // Close modal handlers
    const closeBtn = document.getElementById('close-map-modal');
    const modal = document.getElementById('map-modal');

    if (closeBtn) {
      closeBtn.addEventListener('click', () => {
        if (modal) {
          modal.classList.add('hidden');
        }
      });
    }

    if (modal) {
      // Close on background click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.add('hidden');
        }
      });

      // Close on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
          modal.classList.add('hidden');
        }
      });
    }
  }

  // Run on initial load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', setupMapLink);
  } else {
    setupMapLink();
  }

  // Re-run after view transitions
  document.addEventListener('astro:page-load', setupMapLink);
</script>
